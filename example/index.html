<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>&lt;json-viewer&gt; Element</title>
    <script type="module" defer>
      import { JsonViewerElement } from '../dist/json-viewer-element.es.js'
      // import { JsonViewerElement } from '../src/json-viewer-element.ts'
    </script>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        line-height: 1.6;
      }
      .demo {
        margin-bottom: 30px;
        border: 1px solid #eee;
        border-radius: 8px;
        padding: 20px;
        background: #fafafa;
      }
      .demo h3 {
        margin-top: 0;
        color: #333;
      }
      .demo p {
        color: #666;
        margin-bottom: 15px;
      }
      .feature-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }
      @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
      }
    </style>
  </head>
  <body>
    <h1>&lt;json-viewer&gt; Element åŠŸèƒ½æ¼”ç¤º</h1>

    <div class="demo">
      <h3>ğŸ¨ åŸºç¡€åŠŸèƒ½å±•ç¤º</h3>
      <p>åŒ…å«æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼šboxed è¾¹æ¡†ã€copyable å¤åˆ¶ã€sort æ’åºã€å±•å¼€æ·±åº¦æ§åˆ¶</p>
      <json-viewer id="basic" boxed copyable sort expand-depth="2" theme="dark"></json-viewer>
    </div>

    <div class="feature-list">
      <div class="demo">
        <h3>ğŸ“‹ è‡ªå®šä¹‰å¤åˆ¶åŠŸèƒ½</h3>
        <p>ä¸­æ–‡ç•Œé¢ã€å·¦å¯¹é½ã€3 ç§’å»¶è¿Ÿ</p>
        <json-viewer
          id="copy-custom"
          copyable='{"copyText":"å¤åˆ¶","copiedText":"å·²å¤åˆ¶","timeout":3000,"align":"left"}'
          boxed
          expand-depth="1"
        ></json-viewer>
      </div>

      <div class="demo">
        <h3>ğŸ”’ ç®€æ´æ¨¡å¼</h3>
        <p>æ— è¾¹æ¡†ã€æ— å¤åˆ¶æŒ‰é’®ã€ä¸æ’åº</p>
        <json-viewer id="simple" expand-depth="1"></json-viewer>
      </div>

      <div class="demo">
        <h3>ğŸ“ æ·±å±‚å±•å¼€</h3>
        <p>å±•å¼€æ·±åº¦ä¸º 3 å±‚ï¼ŒæŸ¥çœ‹æ·±å±‚åµŒå¥—æ•°æ®</p>
        <json-viewer id="deep" boxed sort expand-depth="3"></json-viewer>
      </div>

      <div class="demo">
        <h3>ğŸ“Š æ•°ç»„æ•°æ®</h3>
        <p>ä¸“é—¨å±•ç¤ºæ•°ç»„ç±»å‹æ•°æ®çš„æ¸²æŸ“æ•ˆæœ</p>
        <json-viewer id="array" boxed copyable></json-viewer>
      </div>

      <div class="demo">
        <h3>ğŸ¨ è‡ªå®šä¹‰å¤åˆ¶æŒ‰é’®</h3>
        <p>ä½¿ç”¨ slot è‡ªå®šä¹‰å¤åˆ¶æŒ‰é’®æ ·å¼å’Œè¡Œä¸º</p>
        <json-viewer id="custom-copy" boxed copyable='{"align":"left"}' expand-depth="2">
          <button slot="copy-button" class="custom-copy-btn" style="
            background: linear-gradient(45deg, #007acc, #00d4ff);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: transform 0.2s ease;
          " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
            <span>ğŸ“‹</span>
            <span>å¤åˆ¶ JSON</span>
          </button>
        </json-viewer>
      </div>

      <div class="demo">
        <h3>ğŸ”§ è‡ªå®šä¹‰å¤åˆ¶è¡Œä¸º</h3>
        <p>è‡ªå®šä¹‰å¤åˆ¶æˆåŠŸå’Œå¤±è´¥çš„å¤„ç†é€»è¾‘</p>
        <json-viewer id="custom-behavior" boxed copyable expand-depth="1">
          <button slot="copy-button" id="smart-copy-btn" style="
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            position: relative;
          ">
            æ™ºèƒ½å¤åˆ¶
          </button>
        </json-viewer>
        <div id="copy-status" style="margin-top: 10px; padding: 8px; border-radius: 4px; display: none;"></div>
      </div>

            <div class="demo">
        <h3>ğŸ›ï¸ è‡ªå®šä¹‰æŒ‰é’®è¡Œä¸ºæ§åˆ¶</h3>
        <p>ä½¿ç”¨è‡ªå®šä¹‰ slot æŒ‰é’®ï¼Œå®Œå…¨è¦†ç›–é»˜è®¤å¤åˆ¶è¡Œä¸ºï¼Œå®ç°è‡ªå®šä¹‰åŠŸèƒ½</p>
        <json-viewer id="custom-control" boxed copyable expand-depth="1">
          <button slot="copy-button" style="
            background: #6c757d;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
          " onclick="handleCustomClick()">
            è‡ªå®šä¹‰è¡Œä¸º
          </button>
        </json-viewer>
        <div id="custom-result" style="margin-top: 10px; padding: 8px; border-radius: 4px; display: none;"></div>
      </div>

      <div class="demo">
        <h3>ğŸ”„ æŠ˜å å±•å¼€æ§åˆ¶</h3>
        <p>å±•ç¤ºæŠ˜å æŒ‰é’®åŠŸèƒ½å’Œçœç•¥å·ç‚¹å‡»å±•å¼€</p>
        <json-viewer id="toggle-demo" boxed copyable expand-depth="0">
          <button slot="copy-button" style="
            background: #17a2b8;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
          ">
            ğŸ“‹ å¤åˆ¶
          </button>
        </json-viewer>
      </div>

      <div class="demo">
        <h3>ğŸ“ å­—ç¬¦ä¸²è§£ææ¨¡å¼</h3>
        <p>parse="false" æ—¶å°†å­—ç¬¦ä¸²åŸæ ·æ˜¾ç¤ºï¼Œä¸è¿›è¡Œ JSON è§£æ</p>
        <json-viewer id="parse-demo" boxed copyable parse="false" expand-depth="1"></json-viewer>
      </div>

      <div class="demo">
        <h3>ğŸ¨ å„ç§æ•°æ®ç±»å‹å±•ç¤º</h3>
        <p>å®Œæ•´å±•ç¤ºæ‰€æœ‰æ”¯æŒçš„æ•°æ®ç±»å‹ï¼šå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ã€nullã€æ—¥æœŸã€å‡½æ•°ã€æ­£åˆ™ç­‰</p>
        <json-viewer id="types-demo" boxed copyable sort expand-depth="2"></json-viewer>
      </div>

      <div class="demo">
        <h3>â­ï¸ ç©ºæ•°æ®å¤„ç†</h3>
        <p>å±•ç¤ºç©ºå¯¹è±¡å’Œç©ºæ•°ç»„çš„æ¸²æŸ“æ•ˆæœ</p>
        <json-viewer id="empty-demo" boxed copyable expand-depth="1"></json-viewer>
      </div>

      <div class="demo">
        <h3>ğŸ¯ äº¤äº’å¼åŠŸèƒ½æµ‹è¯•</h3>
        <p>æµ‹è¯•æ‰€æœ‰äº¤äº’åŠŸèƒ½ï¼šæŠ˜å /å±•å¼€ã€å¤åˆ¶ã€äº‹ä»¶è§¦å‘ç­‰</p>
        <div style="margin-bottom: 10px;">
          <button onclick="toggleAllNodes()" style="margin-right: 10px; padding: 5px 10px;">å…¨éƒ¨æŠ˜å /å±•å¼€</button>
          <button onclick="changeData()" style="margin-right: 10px; padding: 5px 10px;">æ›´æ¢æ•°æ®</button>
          <button onclick="toggleSort()" style="padding: 5px 10px;">åˆ‡æ¢æ’åº</button>
        </div>
        <json-viewer id="interactive-demo" boxed copyable sort expand-depth="1">
          <button slot="copy-button" style="
            background: #28a745;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            animation: pulse 2s infinite;
          ">
            ğŸš€ æ™ºèƒ½å¤åˆ¶
          </button>
        </json-viewer>
        <div id="interaction-log" style="
          margin-top: 10px;
          padding: 10px;
          background: #f8f9fa;
          border-left: 4px solid #007bff;
          border-radius: 4px;
          font-family: monospace;
          font-size: 12px;
          max-height: 200px;
          overflow-y: auto;
        ">
          <div><strong>äº‹ä»¶æ—¥å¿—ï¼š</strong></div>
        </div>
      </div>
    </div>

    <div class="demo">
      <h3>ğŸ“Š åŠŸèƒ½å¯¹æ¯”è¡¨</h3>
      <p>ä¸åŒé…ç½®ä¸‹çš„åŠŸèƒ½å¯¹æ¯”å±•ç¤º</p>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
        <div>
          <h4>æœ€å°é…ç½®</h4>
          <json-viewer id="minimal"></json-viewer>
        </div>
        <div>
          <h4>åŸºç¡€é…ç½®</h4>
          <json-viewer id="basic-config" boxed copyable></json-viewer>
        </div>
        <div>
          <h4>å®Œæ•´é…ç½®</h4>
          <json-viewer id="full-config" boxed copyable sort expand-depth="2">
            <button slot="copy-button" style="background: #007acc; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 11px;">
              ğŸ“‹ å¤åˆ¶
            </button>
          </json-viewer>
        </div>
      </div>
    </div>

    <script>
      const data = {
        name: 'Lruihao',
        age: 18,
        isActive: true,
        score: null,
        date: new Date(),
        fn: () => {},
        regex: /ab+c/i,
        tags: ['developer', 'javascript', 'typescript'],
        emptyArray: [],
        emptyObject: {},
        profile: {
          social: {
            github: 'Lruihao',
            twitter: '@liruihao',
            website: 'https://lruihao.cn',
          },
          skills: ['JavaScript', 'TypeScript', 'Vue', 'React'],
          experience: {
            years: 5,
            level: 'Senior',
            projects: [
              { name: 'Project A', status: 'completed' },
              { name: 'Project B', status: 'in-progress' },
            ],
          },
        },
      }

      const arrayData = [
        { id: 1, name: 'Alice', active: true },
        { id: 2, name: 'Bob', active: false },
        { id: 3, name: 'Charlie', active: true },
        'simple string',
        42,
        null,
        [1, 2, 3],
      ]

      document.addEventListener('DOMContentLoaded', () => {
        // ä¸ºæ‰€æœ‰ç»„ä»¶è®¾ç½®æ•°æ®
        document.getElementById('basic').value = data
        document.getElementById('copy-custom').value = data
        document.getElementById('simple').value = data
        document.getElementById('deep').value = data
        document.getElementById('array').value = arrayData

        // è‡ªå®šä¹‰å¤åˆ¶æŒ‰é’®æµ‹è¯•æ•°æ®
        document.getElementById('custom-copy').value = {
          theme: 'custom',
          features: ['slot support', 'custom events', 'flexible styling'],
          version: '1.0.0'
        };
        
        document.getElementById('custom-behavior').value = {
          message: 'Test custom copy behavior',
          timestamp: new Date().toISOString()
        };
        
        document.getElementById('custom-control').value = {
          message: 'Custom button behavior',
          description: 'This button will copy JSON data and show alert'
        };

        // æŠ˜å å±•å¼€æ¼”ç¤ºæ•°æ®
        document.getElementById('toggle-demo').value = {
          level1: {
            level2: {
              level3: {
                deepData: 'This is deeply nested',
                moreData: [1, 2, 3, 4, 5]
              },
              siblingData: 'At level 2'
            },
            anotherBranch: {
              info: 'Another branch at level 2',
              data: { nested: true }
            }
          },
          topLevel: ['item1', 'item2', 'item3']
        };

        // å­—ç¬¦ä¸²è§£ææ¼”ç¤º
        document.getElementById('parse-demo').value = '{"stringified": "json", "will": "not", "be": "parsed"}';

        // å„ç§æ•°æ®ç±»å‹æ¼”ç¤º
        document.getElementById('types-demo').value = {
          string: 'Hello World',
          number: 42,
          float: 3.14159,
          boolean_true: true,
          boolean_false: false,
          null_value: null,
          // undefined_value: undefined,
          date: new Date('2024-01-01'),
          function: function() { return 'test'; },
          arrow_function: () => 'arrow',
          regexp: /pattern/gi,
          bigint: BigInt(123456789),
          symbol: Symbol('test'),
          array: [1, 'two', true, null],
          nested_object: {
            deep: {
              deeper: {
                value: 'found me!'
              }
            }
          }
        };

        // ç©ºæ•°æ®å¤„ç†æ¼”ç¤º
        document.getElementById('empty-demo').value = {
          emptyObject: {},
          emptyArray: [],
          nullValue: null,
          // undefinedValue: undefined,
          emptyString: '',
          zeroNumber: 0,
          falseBoolean: false,
          nested: {
            stillEmpty: {},
            emptyArrayToo: []
          }
        };
        
        // è‡ªå®šä¹‰å¤åˆ¶è¡Œä¸ºäº‹ä»¶å¤„ç†
        const smartCopyBtn = document.getElementById('smart-copy-btn');
        const copyStatus = document.getElementById('copy-status');
        
        smartCopyBtn.addEventListener('copy-success', (e) => {
          copyStatus.style.display = 'block';
          copyStatus.style.background = '#d4edda';
          copyStatus.style.color = '#155724';
          copyStatus.style.border = '1px solid #c3e6cb';
          copyStatus.innerHTML = `
            âœ… å¤åˆ¶æˆåŠŸï¼<br>
            <small>å·²å¤åˆ¶ ${e.detail.text.split('\n').length} è¡Œæ•°æ®åˆ°å‰ªè´´æ¿</small>
          `;
          
          setTimeout(() => {
            copyStatus.style.display = 'none';
          }, 3000);
        });
        
        smartCopyBtn.addEventListener('copy-error', (e) => {
          copyStatus.style.display = 'block';
          copyStatus.style.background = '#f8d7da';
          copyStatus.style.color = '#721c24';
          copyStatus.style.border = '1px solid #f5c6cb';
          copyStatus.innerHTML = 'âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·é‡è¯•';
          
          setTimeout(() => {
            copyStatus.style.display = 'none';
          }, 3000);
        });

        // äº¤äº’å¼åŠŸèƒ½æµ‹è¯•æ•°æ®
        document.getElementById('interactive-demo').value = {
          currentTime: new Date().toISOString(),
          userAgent: navigator.userAgent,
          features: {
            localStorage: 'localStorage' in window,
            sessionStorage: 'sessionStorage' in window,
            webGL: 'WebGLRenderingContext' in window,
            webAudio: 'AudioContext' in window,
          },
          performance: {
            memory: performance.memory ? performance.memory : 'not available',
            timing: performance.timing ? {
              navigationStart: performance.timing.navigationStart,
              loadEventEnd: performance.timing.loadEventEnd
            } : 'not available'
          }
        };

        // å¯¹æ¯”è¡¨æ•°æ®
        const simpleData = { name: 'Simple', version: '1.0' };
        document.getElementById('minimal').value = simpleData;
        document.getElementById('basic-config').value = simpleData;
        document.getElementById('full-config').value = simpleData;

        // äº‹ä»¶ç›‘å¬
        const interactiveViewer = document.getElementById('interactive-demo');
        const logContainer = document.getElementById('interaction-log');
        
        function addLog(message) {
          const logEntry = document.createElement('div');
          logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
          logEntry.style.marginBottom = '2px';
          logContainer.appendChild(logEntry);
          logContainer.scrollTop = logContainer.scrollHeight;
        }

        // ç›‘å¬toggleäº‹ä»¶
        interactiveViewer.addEventListener('toggle', (e) => {
          addLog(`èŠ‚ç‚¹${e.detail.isCollapsed ? 'æŠ˜å ' : 'å±•å¼€'}`);
        });

        // ç›‘å¬å¤åˆ¶äº‹ä»¶
        interactiveViewer.addEventListener('copy-success', (e) => {
          addLog(`å¤åˆ¶æˆåŠŸ - ${e.detail.text.length} å­—ç¬¦`);
        });

        interactiveViewer.addEventListener('copy-error', (e) => {
          addLog('å¤åˆ¶å¤±è´¥');
        });

        console.log('JSON Viewer Element æ¼”ç¤ºé¡µé¢å·²åŠ è½½å®Œæˆ')
      })

      // äº¤äº’åŠŸèƒ½å®ç°
      let isCollapsed = false;
      function toggleAllNodes() {
        const viewer = document.getElementById('interactive-demo');
        const nodes = viewer.shadowRoot.querySelectorAll('.jv-node');
        nodes.forEach(node => {
          if (isCollapsed) {
            node.classList.remove('collapsed');
          } else {
            node.classList.add('collapsed');
          }
        });
        isCollapsed = !isCollapsed;
      }

      let dataIndex = 0;
      const testDataSets = [
        { type: 'user', name: 'Alice', age: 25, skills: ['JS', 'CSS'] },
        { items: [1, 2, 3], total: 6, active: true },
        { config: { theme: 'dark', lang: 'zh' }, timestamp: Date.now() }
      ];

      function changeData() {
        const viewer = document.getElementById('interactive-demo');
        viewer.value = testDataSets[dataIndex % testDataSets.length];
        dataIndex++;
      }

      let sortEnabled = true;
      function toggleSort() {
        const viewer = document.getElementById('interactive-demo');
        sortEnabled = !sortEnabled;
        if (sortEnabled) {
          viewer.setAttribute('sort', '');
        } else {
          viewer.removeAttribute('sort');
        }
      }

      // è‡ªå®šä¹‰æŒ‰é’®ç‚¹å‡»å¤„ç†
      function handleCustomClick() {
        const resultDiv = document.getElementById('custom-result');
        const viewer = document.getElementById('custom-control');
        const jsonData = viewer.value;
        
        // æ˜¾ç¤ºè‡ªå®šä¹‰æ“ä½œç»“æœ
        resultDiv.style.display = 'block';
        resultDiv.style.background = '#e1f5fe';
        resultDiv.style.color = '#01579b';
        resultDiv.style.border = '1px solid #81d4fa';
        resultDiv.innerHTML = `
          <strong>ğŸ¯ è‡ªå®šä¹‰æ“ä½œæ‰§è¡ŒæˆåŠŸï¼</strong><br>
          <small>æ•°æ®ç±»å‹: ${Array.isArray(jsonData) ? 'Array' : typeof jsonData}</small><br>
          <small>é”®æ•°é‡: ${typeof jsonData === 'object' && jsonData !== null ? Object.keys(jsonData).length : 'N/A'}</small><br>
          <small>æ“ä½œæ—¶é—´: ${new Date().toLocaleTimeString()}</small>
        `;
        
        // 3ç§’åéšè—ç»“æœ
        setTimeout(() => {
          resultDiv.style.display = 'none';
        }, 3000);
        
        console.log('è‡ªå®šä¹‰æŒ‰é’®è¢«ç‚¹å‡»ï¼Œæ•°æ®ï¼š', jsonData);
      }
    </script>
  </body>
</html>
